import{K as _e,_ as Je,y as We,a as Xe,r as s,H as Ze,M as el,b as r,D as fe,o as m,m as B,G as y,J as X,h as o,e as t,w as a,i as ve,F as Z,z as ee,c as h,I as S,k as i,j as w,f as O,v as ye,n as ll,N as Y}from"./index.a520aebf.js";import{l as tl,e as ol,f as al,g as he,h as nl,i as ul,j as dl,k as rl}from"./role.6cb18d90.js";function sl(){return _e({url:"/system/menu/treeselect",method:"get"})}function il(le){return _e({url:"/system/menu/roleMenuTreeselect/"+le,method:"get"})}const pl={class:"app-container"},ml={class:"dialog-footer"},cl={class:"dialog-footer"},fl=We({name:"Role"}),vl=Object.assign(fl,{setup(le){const ge=Xe(),{proxy:v}=ll(),{sys_normal_disable:te}=v.useDict("sys_normal_disable"),oe=s([]),_=s(!1),j=s(!0),$=s(!0),H=s([]),ae=s(!0),ne=s(!0),Q=s(0),U=s(""),I=s([]),R=s([]),M=s(!1),q=s(!1),A=s(!0),E=s(!1),P=s([]),x=s(!1),g=s(null),k=s(null),ke=s([{value:"1",label:"\u5168\u90E8\u6570\u636E\u6743\u9650"},{value:"2",label:"\u81EA\u5B9A\u6570\u636E\u6743\u9650"},{value:"3",label:"\u672C\u90E8\u95E8\u6570\u636E\u6743\u9650"},{value:"4",label:"\u672C\u90E8\u95E8\u53CA\u4EE5\u4E0B\u6570\u636E\u6743\u9650"},{value:"5",label:"\u4EC5\u672C\u4EBA\u6570\u636E\u6743\u9650"}]),be=Ze({form:{},queryParams:{pageNum:1,pageSize:10,roleName:void 0,roleKey:void 0,status:void 0},rules:{roleName:[{required:!0,message:"\u89D2\u8272\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],roleKey:[{required:!0,message:"\u6743\u9650\u5B57\u7B26\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],roleSort:[{required:!0,message:"\u89D2\u8272\u987A\u5E8F\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}}),{queryParams:c,form:u,rules:Ve}=el(be);function b(){j.value=!0,tl(v.addDateRange(c.value,I.value)).then(n=>{oe.value=n.rows,Q.value=n.total,j.value=!1})}function z(){c.value.pageNum=1,b()}function Ce(){I.value=[],v.resetForm("queryRef"),z()}function ue(n){const e=n.roleId||H.value;v.$modal.confirm('\u662F\u5426\u786E\u8BA4\u5220\u9664\u89D2\u8272\u7F16\u53F7\u4E3A"'+e+'"\u7684\u6570\u636E\u9879?').then(function(){return ol(e)}).then(()=>{b(),v.$modal.msgSuccess("\u5220\u9664\u6210\u529F")}).catch(()=>{})}function Se(){v.download("system/role/export",{...c.value},`role_${new Date().getTime()}.xlsx`)}function we(n){H.value=n.map(e=>e.roleId),ae.value=n.length!=1,ne.value=!n.length}function xe(n){let e=n.status==="0"?"\u542F\u7528":"\u505C\u7528";v.$modal.confirm('\u786E\u8BA4\u8981"'+e+'""'+n.roleName+'"\u89D2\u8272\u5417?').then(function(){return al(n.roleId,n.status)}).then(()=>{v.$modal.msgSuccess(e+"\u6210\u529F")}).catch(function(){n.status=n.status==="0"?"1":"0"})}function Ke(n){ge.push("/system/role-auth/user/"+n.roleId)}function Ne(){sl().then(n=>{R.value=n.data})}function Ue(){let n=k.value.getCheckedKeys(),e=k.value.getHalfCheckedKeys();return n.unshift.apply(n,e),n}function D(){g.value!=null&&g.value.setCheckedKeys([]),M.value=!1,q.value=!1,A.value=!0,E.value=!1,u.value={roleId:void 0,roleName:void 0,roleKey:void 0,roleSort:0,status:"0",menuIds:[],deptIds:[],menuCheckStrictly:!0,deptCheckStrictly:!0,remark:void 0},v.resetForm("roleRef")}function Ie(){D(),Ne(),_.value=!0,U.value="\u6DFB\u52A0\u89D2\u8272"}function de(n){D();const e=n.roleId||H.value,p=Re(e);he(e).then(d=>{u.value=d.data,u.value.roleSort=Number(u.value.roleSort),_.value=!0,Y(()=>{p.then(F=>{F.checkedKeys.forEach(J=>{Y(()=>{g.value.setChecked(J,!0,!1)})})})}),U.value="\u4FEE\u6539\u89D2\u8272"})}function Re(n){return il(n).then(e=>(R.value=e.menus,e))}function De(n){return rl(n).then(e=>(P.value=e.depts,e))}function re(n,e){if(e=="menu"){let p=R.value;for(let d=0;d<p.length;d++)g.value.store.nodesMap[p[d].id].expanded=n}else if(e=="dept"){let p=P.value;for(let d=0;d<p.length;d++)k.value.store.nodesMap[p[d].id].expanded=n}}function se(n,e){e=="menu"?g.value.setCheckedNodes(n?R.value:[]):e=="dept"&&k.value.setCheckedNodes(n?P.value:[])}function ie(n,e){e=="menu"?u.value.menuCheckStrictly=!!n:e=="dept"&&(u.value.deptCheckStrictly=!!n)}function pe(){let n=g.value.getCheckedKeys(),e=g.value.getHalfCheckedKeys();return n.unshift.apply(n,e),n}function Te(){v.$refs.roleRef.validate(n=>{n&&(u.value.roleId!=null?(u.value.menuIds=pe(),nl(u.value).then(e=>{v.$modal.msgSuccess("\u4FEE\u6539\u6210\u529F"),_.value=!1,b()})):(u.value.menuIds=pe(),ul(u.value).then(e=>{v.$modal.msgSuccess("\u65B0\u589E\u6210\u529F"),_.value=!1,b()})))})}function $e(){_.value=!1,D()}function Me(n){n!=="2"&&k.value.setCheckedKeys([])}function qe(n){D();const e=De(n.roleId);he(n.roleId).then(p=>{u.value=p.data,x.value=!0,Y(()=>{e.then(d=>{Y(()=>{k.value&&k.value.setCheckedKeys(d.checkedKeys)})})}),U.value="\u5206\u914D\u6570\u636E\u6743\u9650"})}function Ae(){u.value.roleId!=null&&(u.value.deptIds=Ue(),dl(u.value).then(n=>{v.$modal.msgSuccess("\u4FEE\u6539\u6210\u529F"),x.value=!1,b()}))}function Ee(){x.value=!1,D()}return b(),(n,e)=>{const p=r("el-input"),d=r("el-form-item"),F=r("el-option"),G=r("el-select"),J=r("el-date-picker"),f=r("el-button"),W=r("el-form"),L=r("el-col"),Pe=r("right-toolbar"),ze=r("el-row"),V=r("el-table-column"),Fe=r("el-switch"),T=r("el-tooltip"),Le=r("el-table"),Be=r("pagination"),Oe=r("question-filled"),Ye=r("el-icon"),je=r("el-input-number"),He=r("el-radio"),Qe=r("el-radio-group"),K=r("el-checkbox"),me=r("el-tree"),ce=r("el-dialog"),C=fe("hasPermi"),Ge=fe("loading");return m(),B("div",pl,[y(t(W,{model:o(c),ref:"queryRef",inline:!0,"label-width":"68px"},{default:a(()=>[t(d,{label:"\u89D2\u8272\u540D\u79F0",prop:"roleName"},{default:a(()=>[t(p,{modelValue:o(c).roleName,"onUpdate:modelValue":e[0]||(e[0]=l=>o(c).roleName=l),placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u540D\u79F0",clearable:"",style:{width:"240px"},onKeyup:ve(z,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),t(d,{label:"\u6743\u9650\u5B57\u7B26",prop:"roleKey"},{default:a(()=>[t(p,{modelValue:o(c).roleKey,"onUpdate:modelValue":e[1]||(e[1]=l=>o(c).roleKey=l),placeholder:"\u8BF7\u8F93\u5165\u6743\u9650\u5B57\u7B26",clearable:"",style:{width:"240px"},onKeyup:ve(z,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),t(d,{label:"\u72B6\u6001",prop:"status"},{default:a(()=>[t(G,{modelValue:o(c).status,"onUpdate:modelValue":e[2]||(e[2]=l=>o(c).status=l),placeholder:"\u89D2\u8272\u72B6\u6001",clearable:"",style:{width:"240px"}},{default:a(()=>[(m(!0),B(Z,null,ee(o(te),l=>(m(),h(F,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(d,{label:"\u521B\u5EFA\u65F6\u95F4",style:{width:"308px"}},{default:a(()=>[t(J,{modelValue:o(I),"onUpdate:modelValue":e[3]||(e[3]=l=>S(I)?I.value=l:null),"value-format":"YYYY-MM-DD",type:"daterange","range-separator":"-","start-placeholder":"\u5F00\u59CB\u65E5\u671F","end-placeholder":"\u7ED3\u675F\u65E5\u671F"},null,8,["modelValue"])]),_:1}),t(d,null,{default:a(()=>[t(f,{type:"primary",icon:"Search",onClick:z},{default:a(()=>[i("\u641C\u7D22")]),_:1}),t(f,{icon:"Refresh",onClick:Ce},{default:a(()=>[i("\u91CD\u7F6E")]),_:1})]),_:1})]),_:1},8,["model"]),[[X,o($)]]),t(ze,{gutter:10,class:"mb8"},{default:a(()=>[t(L,{span:1.5},{default:a(()=>[y((m(),h(f,{type:"primary",plain:"",icon:"Plus",onClick:Ie},{default:a(()=>[i("\u65B0\u589E")]),_:1})),[[C,["system:role:add"]]])]),_:1},8,["span"]),t(L,{span:1.5},{default:a(()=>[y((m(),h(f,{type:"success",plain:"",icon:"Edit",disabled:o(ae),onClick:de},{default:a(()=>[i("\u4FEE\u6539")]),_:1},8,["disabled"])),[[C,["system:role:edit"]]])]),_:1},8,["span"]),t(L,{span:1.5},{default:a(()=>[y((m(),h(f,{type:"danger",plain:"",icon:"Delete",disabled:o(ne),onClick:ue},{default:a(()=>[i("\u5220\u9664")]),_:1},8,["disabled"])),[[C,["system:role:remove"]]])]),_:1},8,["span"]),t(L,{span:1.5},{default:a(()=>[y((m(),h(f,{type:"warning",plain:"",icon:"Download",onClick:Se},{default:a(()=>[i("\u5BFC\u51FA")]),_:1})),[[C,["system:role:export"]]])]),_:1},8,["span"]),t(Pe,{showSearch:o($),"onUpdate:showSearch":e[4]||(e[4]=l=>S($)?$.value=l:null),onQueryTable:b},null,8,["showSearch"])]),_:1}),w(" \u8868\u683C\u6570\u636E "),y((m(),h(Le,{data:o(oe),onSelectionChange:we},{default:a(()=>[t(V,{type:"selection",width:"55",align:"center"}),t(V,{label:"\u89D2\u8272\u7F16\u53F7",prop:"roleId",width:"120"}),t(V,{label:"\u89D2\u8272\u540D\u79F0",prop:"roleName","show-overflow-tooltip":!0,width:"150"}),t(V,{label:"\u6743\u9650\u5B57\u7B26",prop:"roleKey","show-overflow-tooltip":!0,width:"150"}),t(V,{label:"\u663E\u793A\u987A\u5E8F",prop:"roleSort",width:"100"}),t(V,{label:"\u72B6\u6001",align:"center",width:"100"},{default:a(l=>[t(Fe,{modelValue:l.row.status,"onUpdate:modelValue":N=>l.row.status=N,"active-value":"0","inactive-value":"1",onChange:N=>xe(l.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),t(V,{label:"\u521B\u5EFA\u65F6\u95F4",align:"center",prop:"createTime"},{default:a(l=>[O("span",null,ye(n.parseTime(l.row.createTime)),1)]),_:1}),t(V,{label:"\u64CD\u4F5C",align:"center","class-name":"small-padding fixed-width"},{default:a(l=>[l.row.roleId!==1?(m(),h(T,{key:0,content:"\u4FEE\u6539",placement:"top"},{default:a(()=>[y(t(f,{link:"",type:"primary",icon:"Edit",onClick:N=>de(l.row)},null,8,["onClick"]),[[C,["system:role:edit"]]])]),_:2},1024)):w("v-if",!0),l.row.roleId!==1?(m(),h(T,{key:1,content:"\u5220\u9664",placement:"top"},{default:a(()=>[y(t(f,{link:"",type:"primary",icon:"Delete",onClick:N=>ue(l.row)},null,8,["onClick"]),[[C,["system:role:remove"]]])]),_:2},1024)):w("v-if",!0),l.row.roleId!==1?(m(),h(T,{key:2,content:"\u6570\u636E\u6743\u9650",placement:"top"},{default:a(()=>[y(t(f,{link:"",type:"primary",icon:"CircleCheck",onClick:N=>qe(l.row)},null,8,["onClick"]),[[C,["system:role:edit"]]])]),_:2},1024)):w("v-if",!0),l.row.roleId!==1?(m(),h(T,{key:3,content:"\u5206\u914D\u7528\u6237",placement:"top"},{default:a(()=>[y(t(f,{link:"",type:"primary",icon:"User",onClick:N=>Ke(l.row)},null,8,["onClick"]),[[C,["system:role:edit"]]])]),_:2},1024)):w("v-if",!0)]),_:1})]),_:1},8,["data"])),[[Ge,o(j)]]),y(t(Be,{total:o(Q),page:o(c).pageNum,"onUpdate:page":e[5]||(e[5]=l=>o(c).pageNum=l),limit:o(c).pageSize,"onUpdate:limit":e[6]||(e[6]=l=>o(c).pageSize=l),onPagination:b},null,8,["total","page","limit"]),[[X,o(Q)>0]]),w(" \u6DFB\u52A0\u6216\u4FEE\u6539\u89D2\u8272\u914D\u7F6E\u5BF9\u8BDD\u6846 "),t(ce,{title:o(U),modelValue:o(_),"onUpdate:modelValue":e[18]||(e[18]=l=>S(_)?_.value=l:null),width:"500px","append-to-body":""},{footer:a(()=>[O("div",ml,[t(f,{type:"primary",onClick:Te},{default:a(()=>[i("\u786E \u5B9A")]),_:1}),t(f,{onClick:$e},{default:a(()=>[i("\u53D6 \u6D88")]),_:1})])]),default:a(()=>[t(W,{ref:"roleRef",model:o(u),rules:o(Ve),"label-width":"100px"},{default:a(()=>[t(d,{label:"\u89D2\u8272\u540D\u79F0",prop:"roleName"},{default:a(()=>[t(p,{modelValue:o(u).roleName,"onUpdate:modelValue":e[7]||(e[7]=l=>o(u).roleName=l),placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u540D\u79F0"},null,8,["modelValue"])]),_:1}),t(d,{prop:"roleKey"},{label:a(()=>[O("span",null,[t(T,{content:"\u63A7\u5236\u5668\u4E2D\u5B9A\u4E49\u7684\u6743\u9650\u5B57\u7B26\uFF0C\u5982\uFF1A@PreAuthorize(`@ss.hasRole('admin')`)",placement:"top"},{default:a(()=>[t(Ye,null,{default:a(()=>[t(Oe)]),_:1})]),_:1}),i(" \u6743\u9650\u5B57\u7B26 ")])]),default:a(()=>[t(p,{modelValue:o(u).roleKey,"onUpdate:modelValue":e[8]||(e[8]=l=>o(u).roleKey=l),placeholder:"\u8BF7\u8F93\u5165\u6743\u9650\u5B57\u7B26"},null,8,["modelValue"])]),_:1}),t(d,{label:"\u89D2\u8272\u987A\u5E8F",prop:"roleSort"},{default:a(()=>[t(je,{modelValue:o(u).roleSort,"onUpdate:modelValue":e[9]||(e[9]=l=>o(u).roleSort=l),"controls-position":"right",min:0},null,8,["modelValue"])]),_:1}),t(d,{label:"\u72B6\u6001"},{default:a(()=>[t(Qe,{modelValue:o(u).status,"onUpdate:modelValue":e[10]||(e[10]=l=>o(u).status=l)},{default:a(()=>[(m(!0),B(Z,null,ee(o(te),l=>(m(),h(He,{key:l.value,label:l.value},{default:a(()=>[i(ye(l.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(d,{label:"\u83DC\u5355\u6743\u9650"},{default:a(()=>[t(K,{modelValue:o(M),"onUpdate:modelValue":e[11]||(e[11]=l=>S(M)?M.value=l:null),onChange:e[12]||(e[12]=l=>re(l,"menu"))},{default:a(()=>[i("\u5C55\u5F00/\u6298\u53E0")]),_:1},8,["modelValue"]),t(K,{modelValue:o(q),"onUpdate:modelValue":e[13]||(e[13]=l=>S(q)?q.value=l:null),onChange:e[14]||(e[14]=l=>se(l,"menu"))},{default:a(()=>[i("\u5168\u9009/\u5168\u4E0D\u9009")]),_:1},8,["modelValue"]),t(K,{modelValue:o(u).menuCheckStrictly,"onUpdate:modelValue":e[15]||(e[15]=l=>o(u).menuCheckStrictly=l),onChange:e[16]||(e[16]=l=>ie(l,"menu"))},{default:a(()=>[i("\u7236\u5B50\u8054\u52A8")]),_:1},8,["modelValue"]),t(me,{class:"tree-border",data:o(R),"show-checkbox":"",ref_key:"menuRef",ref:g,"node-key":"id","check-strictly":!o(u).menuCheckStrictly,"empty-text":"\u52A0\u8F7D\u4E2D\uFF0C\u8BF7\u7A0D\u5019",props:{label:"label",children:"children"}},null,8,["data","check-strictly"])]),_:1}),t(d,{label:"\u5907\u6CE8"},{default:a(()=>[t(p,{modelValue:o(u).remark,"onUpdate:modelValue":e[17]||(e[17]=l=>o(u).remark=l),type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"]),w(" \u5206\u914D\u89D2\u8272\u6570\u636E\u6743\u9650\u5BF9\u8BDD\u6846 "),t(ce,{title:o(U),modelValue:o(x),"onUpdate:modelValue":e[28]||(e[28]=l=>S(x)?x.value=l:null),width:"500px","append-to-body":""},{footer:a(()=>[O("div",cl,[t(f,{type:"primary",onClick:Ae},{default:a(()=>[i("\u786E \u5B9A")]),_:1}),t(f,{onClick:Ee},{default:a(()=>[i("\u53D6 \u6D88")]),_:1})])]),default:a(()=>[t(W,{model:o(u),"label-width":"80px"},{default:a(()=>[t(d,{label:"\u89D2\u8272\u540D\u79F0"},{default:a(()=>[t(p,{modelValue:o(u).roleName,"onUpdate:modelValue":e[19]||(e[19]=l=>o(u).roleName=l),disabled:!0},null,8,["modelValue"])]),_:1}),t(d,{label:"\u6743\u9650\u5B57\u7B26"},{default:a(()=>[t(p,{modelValue:o(u).roleKey,"onUpdate:modelValue":e[20]||(e[20]=l=>o(u).roleKey=l),disabled:!0},null,8,["modelValue"])]),_:1}),t(d,{label:"\u6743\u9650\u8303\u56F4"},{default:a(()=>[t(G,{modelValue:o(u).dataScope,"onUpdate:modelValue":e[21]||(e[21]=l=>o(u).dataScope=l),onChange:Me},{default:a(()=>[(m(!0),B(Z,null,ee(o(ke),l=>(m(),h(F,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),y(t(d,{label:"\u6570\u636E\u6743\u9650"},{default:a(()=>[t(K,{modelValue:o(A),"onUpdate:modelValue":e[22]||(e[22]=l=>S(A)?A.value=l:null),onChange:e[23]||(e[23]=l=>re(l,"dept"))},{default:a(()=>[i("\u5C55\u5F00/\u6298\u53E0")]),_:1},8,["modelValue"]),t(K,{modelValue:o(E),"onUpdate:modelValue":e[24]||(e[24]=l=>S(E)?E.value=l:null),onChange:e[25]||(e[25]=l=>se(l,"dept"))},{default:a(()=>[i("\u5168\u9009/\u5168\u4E0D\u9009")]),_:1},8,["modelValue"]),t(K,{modelValue:o(u).deptCheckStrictly,"onUpdate:modelValue":e[26]||(e[26]=l=>o(u).deptCheckStrictly=l),onChange:e[27]||(e[27]=l=>ie(l,"dept"))},{default:a(()=>[i("\u7236\u5B50\u8054\u52A8")]),_:1},8,["modelValue"]),t(me,{class:"tree-border",data:o(P),"show-checkbox":"","default-expand-all":"",ref_key:"deptRef",ref:k,"node-key":"id","check-strictly":!o(u).deptCheckStrictly,"empty-text":"\u52A0\u8F7D\u4E2D\uFF0C\u8BF7\u7A0D\u5019",props:{label:"label",children:"children"}},null,8,["data","check-strictly"])]),_:1},512),[[X,o(u).dataScope==2]])]),_:1},8,["model"])]),_:1},8,["title","modelValue"])])}}}),_l=Je(vl,[["__file","/home/runner/work/alinesno-infra-ui/alinesno-infra-ui/alinesno-ui/src/views/system/role/index.vue"]]);export{_l as default};
